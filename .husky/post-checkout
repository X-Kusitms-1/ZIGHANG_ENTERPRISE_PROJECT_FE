#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# $1: ì´ì „ HEADì˜ ref
# $2: ìƒˆë¡œìš´ HEADì˜ ref  
# $3: ë¸Œëœì¹˜ ì²´í¬ì•„ì›ƒì¸ì§€ íŒŒì¼ ì²´í¬ì•„ì›ƒì¸ì§€ êµ¬ë¶„ (1: ë¸Œëœì¹˜, 0: íŒŒì¼)

# ë¸Œëœì¹˜ ì²´í¬ì•„ì›ƒì¸ ê²½ìš°ì—ë§Œ ì‹¤í–‰
if [ "$3" = "1" ]; then
  echo "ğŸ”„ ë¸Œëœì¹˜ ë³€ê²½ ê°ì§€ë¨..."
  
  # package.jsonì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸
  if git diff --name-only $1 $2 | grep -q "package.json\|pnpm-lock.yaml"; then
    echo "ğŸ“¦ íŒ¨í‚¤ì§€ ë³€ê²½ì‚¬í•­ ê°ì§€ë¨. pnpm install ì‹¤í–‰ ì¤‘..."
    pnpm install
    echo "âœ… íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ!"
  else
    echo "ğŸ“¦ íŒ¨í‚¤ì§€ ë³€ê²½ì‚¬í•­ ì—†ìŒ"
  fi
fi
